<!DOCTYPE html>
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="layout">

<head>
    <meta charset="UTF-8">
    <title>My Film Application</title>


</head>

<body>

<div layout:fragment="content">
    <h1>Film Details</h1>

    <div th:if="${film}">
        <dl class="row">
            <dt class="col-sm-2">ID:</dt>
            <dd class="col-sm-10">
                <span th:text="${film.id}"></span>
            </dd>
            <hr/>
            <dt class="col-sm-2">Name</dt>
            <dd class="col-sm-10"><span th:text="${film.name}"></span></dd>
            <hr/>
            <dt class="col-sm-2">Description</dt>
            <dd class="col-sm-10">
                <span th:text="${film.description}"></span>
            </dd>
            <hr/>


            <input type="hidden" id="previousRating" th:value="${filmRating}" />

            <form th:action="@{/films/rate}" method="post">
                <input type="hidden" name="filmId" th:value="${film.id}">
                <div class="rating">
                    <label>
                        <input type="radio" name="stars" value="1" />
                        <span class="icon">★</span>
                    </label>
                    <label>
                        <input type="radio" name="stars" value="2" />
                        <span class="icon">★</span>
                        <span class="icon">★</span>
                    </label>
                    <label>
                        <input type="radio" name="stars" value="3" />
                        <span class="icon">★</span>
                        <span class="icon">★</span>
                        <span class="icon">★</span>
                    </label>
                    <label>
                        <input type="radio" name="stars" value="4" />
                        <span class="icon">★</span>
                        <span class="icon">★</span>
                        <span class="icon">★</span>
                        <span class="icon">★</span>
                    </label>
                    <label>
                        <input type="radio" name="stars" value="5" />
                        <span class="icon">★</span>
                        <span class="icon">★</span>
                        <span class="icon">★</span>
                        <span class="icon">★</span>
                        <span class="icon">★</span>
                    </label>
                </div>




                <button type="submit" class="btn btn-primary">Rate Film</button>

            </form>



            <div class="form-group">
                <a th:href="@{/films}" class="btn btn-info" role="button">Films</a>
            </div>
        </dl>
    </div>



    <script>
        document.addEventListener("DOMContentLoaded", function() {
    var previousRating = parseInt(document.getElementById("previousRating").value);

console.log(previousRating);
    if (!isNaN(previousRating)) {
    console.log(previousRating);
        var stars = document.querySelectorAll('input[name="stars"]');
        stars.forEach(function(star) {
            if (parseInt(star.value) <= previousRating) {
                star.checked = true;
            }
        });
    }
});

    </script>

</div>





</body>

</html>
